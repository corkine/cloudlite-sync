{{define "content"}}
<div class="max-w-7xl w-full mx-auto px-4 py-8">
  <h1 class="text-2xl font-bold mb-2">é›†æˆå¸®åŠ©</h1>
  <p class="text-gray-700 mt-4 mb-4">
    CloudLiteSync æä¾›äº†ä¸€ç§ç®€ä¾¿æ˜“è¡Œçš„æœ€ä½³å®è·µæ¥æ»¡è¶³å„ç§å¤æ‚åœºæ™¯ã€‚
  </p>
  <div class="bg-blue-50 border-l-4 border-blue-500 text-blue-800 p-4 mb-6" role="alert">
    <p class="text-xl font-bold">æœ€ä½³å®è·µ</p>
    <ul class="list-none pl-0 mt-2">
      <li><strong>å¯åŠ¨æ—¶ï¼š</strong> å¦‚æœæœ¬åœ°æ•°æ®åº“æ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™ä»äº‘ç«¯æ‹‰å–æœ€æ–°ç‰ˆæœ¬ã€‚</li>
      <li><strong>å…³é—­æ—¶ï¼š</strong> å¦‚æœå½“å‰ä¸æ˜¯ "Debug" æ¨¡å¼ï¼Œåˆ™å°†æœ¬åœ°æ•°æ®åº“ä¸Šä¼ åˆ°äº‘ç«¯ã€‚</li>
    </ul>
  </div>
  <div class="space-y-4 text-gray-700">
    <div>
      <h4 class="font-semibold mb-1">ä¼ ç»Ÿä¸»æœºå¤‡ä»½</h4>
      <p>
        åœ¨ç”Ÿäº§æœåŠ¡å™¨ä¸Šè¿è¡Œæ—¶ï¼Œæ‚¨çš„åº”ç”¨ç¨‹åºæ°¸è¿œä¸ä¼šå¤„äº "Debug" æ¨¡å¼ã€‚å› æ­¤ï¼Œæ¯æ¬¡æœåŠ¡æ­£å¸¸é‡å¯æˆ–å…³é—­æ—¶ï¼ˆé€šè¿‡æ•è· <code>SIGTERM</code>/<code>SIGINT</code> ä¿¡å·ï¼‰ï¼Œéƒ½ä¼šè‡ªåŠ¨è§¦å‘ä¸Šä¼ ï¼Œå°†æœ€æ–°çš„æ•°æ®çŠ¶æ€å®‰å…¨åœ°å¤‡ä»½åˆ°äº‘ç«¯ã€‚è¿™å¤©ç„¶åœ°å®ç°äº†â€œå…³æœºå³å¤‡ä»½â€çš„å¯é æ€§ä¿éšœã€‚
      </p>
    </div>
    <div>
      <h4 class="font-semibold mb-1">Serverless é«˜æ•ˆåˆ©ç”¨</h4>
      <p>
        è¿™ä¸ªé€»è¾‘å®Œç¾å¥‘åˆ Serverless ç¯å¢ƒã€‚å½“ä¸€ä¸ªæ–°çš„å‡½æ•°å®ä¾‹å†·å¯åŠ¨æ—¶ï¼Œå…¶æœ¬åœ°ç¯å¢ƒæ˜¯ç©ºçš„ï¼Œå› æ­¤ä¼šè§¦å‘â€œå¯åŠ¨æ—¶æ‹‰å–â€è§„åˆ™ï¼Œå¿«é€Ÿè·å–çŠ¶æ€ã€‚å‡½æ•°å®ä¾‹åœ¨è¢«å›æ”¶å‰ï¼Œä¼šè§¦å‘å…³æœºä¿¡å·ï¼Œç”±äºå®ƒä¸æ˜¯ "Debug" æ¨¡å¼ï¼Œä¼šè‡ªåŠ¨ä¸Šä¼ æœ€æ–°çš„æ•°æ®çŠ¶æ€ï¼Œä¸ºä¸‹ä¸€ä¸ªå®ä¾‹åšå¥½å‡†å¤‡ã€‚
      </p>
    </div>
    <div>
      <h4 class="font-semibold mb-1">å¼€å‘ç”Ÿäº§åŒæ­¥ä¸éš”ç¦»</h4>
      <p>
        è¿™ä¸ªæµç¨‹æå¤§åœ°æå‡äº†å¼€å‘ä½“éªŒå’Œå®‰å…¨æ€§ã€‚
        <ul class="list-none pl-0 mt-1 space-y-1">
          <li>
            <strong>åŒæ­¥ï¼š</strong> å¼€å‘è€…åˆæ¬¡åœ¨æœ¬åœ°å¯åŠ¨é¡¹ç›®æ—¶ï¼Œç”±äºæ•°æ®åº“æ–‡ä»¶ä¸ºç©ºï¼Œä¼šè‡ªåŠ¨æ‹‰å–ç”Ÿäº§ç¯å¢ƒçš„æœ€æ–°æ•°æ®ï¼Œç¬é—´åˆ›å»ºä¸€ä¸ªé«˜ä¿çœŸçš„å¼€å‘ç¯å¢ƒã€‚
          </li>
          <li>
            <strong>éš”ç¦»ï¼š</strong> å¼€å‘è€…åœ¨æœ¬åœ°ä»¥ "Debug" æ¨¡å¼è¿è¡Œç¨‹åºã€‚æ ¹æ®è§„åˆ™ï¼Œæ­¤æ¨¡å¼ä¸‹å…³é—­æ—¶ä¸ä¼šä¸Šä¼ æ•°æ®ã€‚è¿™ä»æœºåˆ¶ä¸Šä¿è¯äº†æœ¬åœ°çš„ä»»ä½•å®éªŒæ€§ä¿®æ”¹éƒ½ä¸ä¼šæ±¡æŸ“ç”Ÿäº§æ•°æ®ï¼Œæä¾›äº†ä¸€ä¸ªç»å¯¹å®‰å…¨çš„å¼€å‘æ²™ç›’ã€‚
          </li>
        </ul>
      </p>
    </div>
  </div>
  
  <p class="mt-8 mb-4 text-gray-700">
    ä¸‹é¢æä¾›äº†é€šè¿‡ REST API å’Œç¼–ç¨‹è¯­è¨€é›†æˆ CloudLiteSync çš„ç¤ºä¾‹ã€‚
  </p>
  <div class="bg-blue-50 border-l-4 border-blue-500 text-blue-800 p-4 mb-6" role="alert">
    <h2 class="text-xl font-semibold mb-2">API è¯´æ˜</h2>
    <ul class="list-none pl-0 ">
      <li>
        <b>ä¸Šä¼ æ•°æ®åº“ï¼š</b>
        <code>POST /api/{project}</code>
        ï¼Œform-data å‚æ•°ï¼š<code>token</code>ï¼ˆå‡­è¯ï¼‰ã€<code>description</code>ï¼ˆç‰ˆæœ¬æè¿°ï¼Œå¯é€‰ï¼‰ã€<code>database</code>ï¼ˆæ•°æ®åº“æ–‡ä»¶ï¼‰
      </li>
      <li>
        <b>ä¸‹è½½æ•°æ®åº“ï¼š</b>
        <code>GET /api/{project}/latest?token=YOUR_TOKEN</code>
        ï¼Œå‚æ•°ï¼š<code>project</code>ï¼ˆé¡¹ç›®åï¼‰ã€<code>token</code>ï¼ˆå‡­è¯ï¼‰
      </li>
      <li>
        <b>ä¸‹è½½æ•°æ®åº“ï¼š</b>
        <code>GET /api/{project}/{file_hash}?token=YOUR_TOKEN</code>
        ï¼Œå‚æ•°ï¼š<code>project</code>ï¼ˆé¡¹ç›®åï¼‰ã€<code>file_hash</code>ï¼ˆæ–‡ä»¶å“ˆå¸Œï¼‰ã€<code>token</code>ï¼ˆå‡­è¯ï¼‰
      </li>
      <li>
        <b>æ£€æŸ¥æ•°æ®åº“ï¼š</b>
        <code>GET /api/{project}/info/{file_hash}?token=YOUR_TOKEN</code>
        ï¼Œå‚æ•°ï¼š<code>project</code>ï¼ˆé¡¹ç›®åï¼‰ã€<code>file_hash</code>ï¼ˆæ–‡ä»¶å“ˆå¸Œï¼‰ã€<code>token</code>ï¼ˆå‡­è¯ï¼‰
      </li>
    </ul>
  </div>

  <div x-data="{ 
    showCurl: false, 
    showGo: false, 
    showClojure: false, 
    showTypeScript: false, 
    showDart: false 
  }" class="mb-8">
    <h2 class="text-xl font-semibold mt-8 mb-4">ç¼–ç¨‹è¯­è¨€ç¤ºä¾‹</h2>
    <div class="flex flex-wrap gap-3 mb-6">
      <button @click="showCurl = true" class="bg-blue-500 hover:bg-blue-600 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200 shadow-sm">
        <span class="mr-2">ğŸ“‹</span>curl
      </button>
      <button @click="showGo = true" class="bg-blue-500 hover:bg-blue-600 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200 shadow-sm">
        <span class="mr-2">ğŸ¹</span>Go
      </button>
      <button @click="showClojure = true" class="bg-blue-500 hover:bg-blue-600 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200 shadow-sm">
        <span class="mr-2">â˜•</span>Clojure
      </button>
      <button @click="showTypeScript = true" class="bg-blue-500 hover:bg-blue-600 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200 shadow-sm">
        <span class="mr-2">ğŸ“˜</span>TypeScript
      </button>
      <button @click="showDart = true" class="bg-blue-500 hover:bg-blue-600 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200 shadow-sm">
        <span class="mr-2">ğŸ¯</span>Dart
      </button>
    </div>
    
    <!-- curl å¼¹çª— -->
    <div x-show="showCurl" x-cloak class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
      <div class="bg-white rounded-lg p-6 max-w-4xl w-full mx-4 max-h-[80vh] overflow-y-auto scrollbar-hide">
        <div class="flex justify-between items-center mb-4">
          <h3 class="text-xl font-semibold">ğŸ“‹ curl ç¤ºä¾‹</h3>
          <button @click="showCurl = false" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
        </div>
        <pre class="bg-gray-100 rounded p-4 overflow-x-auto text-sm"><code># ä¸Šä¼ æ•°æ®åº“
curl -X POST "http://your-server/api/your_project" \
  -F "token=YOUR_TOKEN" \
  -F "description=æœ¬æ¬¡æ›´æ–°è¯´æ˜ï¼ˆå¯é€‰ï¼‰" \
  -F "database=@data.db"

# ä¸‹è½½æœ€æ–°æ•°æ®åº“
curl -o data.db "http://your-server/api/your_project/latest?token=YOUR_TOKEN"

# ä¸‹è½½æŒ‡å®šç‰ˆæœ¬æ•°æ®åº“
curl -o data.db "http://your-server/api/your_project/{hash}?token=YOUR_TOKEN"</code></pre>
      </div>
    </div>
    
    <!-- Go å¼¹çª— -->
    <div x-show="showGo" x-cloak class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
      <div class="bg-white rounded-lg p-6 max-w-4xl w-full mx-4 max-h-[80vh] overflow-y-auto scrollbar-hide">
        <div class="flex justify-between items-center mb-4">
          <h3 class="text-xl font-semibold">ğŸ¹ Go ç¤ºä¾‹</h3>
          <button @click="showGo = false" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
        </div>
        <pre class="bg-gray-100 rounded p-4 overflow-x-auto text-sm"><code>package main
import (
  "bytes"
  "fmt"
  "io"
  "mime/multipart"
  "net/http"
  "os"
  "os/signal"
  "syscall"
  "time"
)

const (
  serverURL = "http://your-server/api/your_project"
  token     = "YOUR_TOKEN"
  dbPath    = "data.db"
)

func downloadLatestDB() error {
  resp, err := http.Get(serverURL + "/latest?token=" + token)
  if err != nil {
    return err
  }
  defer resp.Body.Close()
  
  out, err := os.Create(dbPath)
  if err != nil {
    return err
  }
  defer out.Close()
  
  _, err = io.Copy(out, resp.Body)
  return err
}

func uploadDB() error {
  file, err := os.Open(dbPath)
  if err != nil {
    return err
  }
  defer file.Close()
  
  body := &bytes.Buffer{}
  writer := multipart.NewWriter(body)
  writer.WriteField("token", token)
  writer.WriteField("description", "Upload at "+time.Now().Format("2006-01-02 15:04:05"))
  part, err := writer.CreateFormFile("database", "data.db")
  if err != nil {
    return err
  }
  io.Copy(part, file)
  writer.Close()
  
  req, err := http.NewRequest("POST", serverURL, body)
  if err != nil {
    return err
  }
  req.Header.Set("Content-Type", writer.FormDataContentType())
  
  resp, err := http.DefaultClient.Do(req)
  if err != nil {
    return err
  }
  defer resp.Body.Close()
  return nil
}

func main() {
  if _, err := os.Stat(dbPath); os.IsNotExist(err) {
    fmt.Println("æ•°æ®åº“æ–‡ä»¶ä¸å­˜åœ¨ï¼Œä»äº‘ç«¯ä¸‹è½½æœ€æ–°ç‰ˆæœ¬...")
    if err := downloadLatestDB(); err != nil {
      fmt.Printf("ä¸‹è½½å¤±è´¥: %v\n", err)
    } else {
      fmt.Println("ä¸‹è½½æˆåŠŸ")
    }
  }
  
  sigChan := make(chan os.Signal, 1)
  signal.Notify(sigChan, syscall.SIGINT, syscall.SIGTERM)
  
  go func() {
    <-sigChan
    fmt.Println("æ¥æ”¶åˆ°å…³é—­ä¿¡å·ï¼Œå‡†å¤‡ä¸Šä¼ æ•°æ®åº“...")
    if err := uploadDB(); err != nil {
      fmt.Printf("ä¸Šä¼ å¤±è´¥: %v\n", err)
    } else {
      fmt.Println("ä¸Šä¼ æˆåŠŸ")
    }
    os.Exit(0)
  }()
}</code></pre>
      </div>
    </div>
    
    <!-- Clojure å¼¹çª— -->
    <div x-show="showClojure" x-cloak class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
      <div class="bg-white rounded-lg p-6 max-w-4xl w-full mx-4 max-h-[80vh] overflow-y-auto scrollbar-hide">
        <div class="flex justify-between items-center mb-4">
          <h3 class="text-xl font-semibold">â˜• Clojure ç¤ºä¾‹</h3>
          <button @click="showClojure = false" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
        </div>
        <pre class="bg-gray-100 rounded p-4 overflow-x-auto text-sm"><code>(ns example
  (:require [clj-http.client :as client]
            [clojure.java.io :as io]
            [clojure.string :as str]))

(def server-url "http://your-server/api/your_project")
(def token "YOUR_TOKEN")
(def db-path "data.db")

(defn download-latest-db []
  (println "æ•°æ®åº“æ–‡ä»¶ä¸å­˜åœ¨ï¼Œä»äº‘ç«¯ä¸‹è½½æœ€æ–°ç‰ˆæœ¬...")
  (try
    (with-open [in (client/get (str server-url "/latest?token=" token) {:as :stream})
                out (io/output-stream db-path)]
      (io/copy (:body in) out))
    (println "ä¸‹è½½æˆåŠŸ")
    :success
    (catch Exception e
      (println "ä¸‹è½½å¤±è´¥:" (.getMessage e))
      :error)))

(defn upload-db []
  (println "æ¥æ”¶åˆ°å…³é—­ä¿¡å·ï¼Œå‡†å¤‡ä¸Šä¼ æ•°æ®åº“...")
  (try
    (client/post server-url
      {:multipart [{:name "token" :content token}
                   {:name "description" :content (str "Upload at " (java.util.Date.))}
                   {:name "database" :content (io/file db-path)}]})
    (println "ä¸Šä¼ æˆåŠŸ")
    :success
    (catch Exception e
      (println "ä¸Šä¼ å¤±è´¥:" (.getMessage e))
      :error)))

(defn -main []
  ;; å¯åŠ¨æ—¶ï¼šå¦‚æœæ–‡ä»¶ä¸å­˜åœ¨åˆ™ä¸‹è½½
  (when-not (.exists (io/file db-path))
    (download-latest-db))
  
  ;; è®¾ç½®å…³é—­é’©å­
  (.addShutdownHook (Runtime/getRuntime)
    (Thread. (fn []
               (upload-db)
               (System/exit 0))))
  
  ;; ä½ çš„ä¸»ç¨‹åºé€»è¾‘
  (println "ç¨‹åºè¿è¡Œä¸­...")
  (Thread/sleep Long/MAX_VALUE))</code></pre>
      </div>
    </div>
    
    <!-- TypeScript å¼¹çª— -->
    <div x-show="showTypeScript" x-cloak class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
      <div class="bg-white rounded-lg p-6 max-w-4xl w-full mx-4 max-h-[80vh] overflow-y-auto scrollbar-hide">
        <div class="flex justify-between items-center mb-4">
          <h3 class="text-xl font-semibold">ğŸ“˜ TypeScript ç¤ºä¾‹ (Node.js)</h3>
          <button @click="showTypeScript = false" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
        </div>
        <pre class="bg-gray-100 rounded p-4 overflow-x-auto text-sm"><code>import fs from 'fs';
import axios from 'axios';
import FormData from 'form-data';
import path from 'path';

const serverURL = 'http://your-server/api/your_project';
const token = 'YOUR_TOKEN';
const dbPath = 'data.db';

async function downloadLatestDB(): Promise<void> {
  console.log('æ•°æ®åº“æ–‡ä»¶ä¸å­˜åœ¨ï¼Œä»äº‘ç«¯ä¸‹è½½æœ€æ–°ç‰ˆæœ¬...');
  try {
    const response = await axios.get(`${serverURL}/latest?token=${token}`, { 
      responseType: 'stream' 
    });
    const writer = fs.createWriteStream(dbPath);
    response.data.pipe(writer);
    
    return new Promise((resolve, reject) => {
      writer.on('finish', () => {
        console.log('ä¸‹è½½æˆåŠŸ');
        resolve();
      });
      writer.on('error', reject);
    });
  } catch (error) {
    console.error('ä¸‹è½½å¤±è´¥:', error);
    throw error;
  }
}

async function uploadDB(): Promise<void> {
  console.log('æ¥æ”¶åˆ°å…³é—­ä¿¡å·ï¼Œå‡†å¤‡ä¸Šä¼ æ•°æ®åº“...');
  try {
    const form = new FormData();
    form.append('token', token);
    form.append('description', `Upload at ${new Date().toISOString()}`);
    form.append('database', fs.createReadStream(dbPath));
    
    await axios.post(serverURL, form, {
      headers: form.getHeaders()
    });
    console.log('ä¸Šä¼ æˆåŠŸ');
  } catch (error) {
    console.error('ä¸Šä¼ å¤±è´¥:', error);
    throw error;
  }
}

async function main() {
  if (!fs.existsSync(dbPath)) {
    await downloadLatestDB();
  }
  
  const isDebug = process.env.NODE_ENV === 'development';
  
  process.on('SIGINT', async () => {
    if (!isDebug) {
      await uploadDB();
    }
    process.exit(0);
  });
  
  process.on('SIGTERM', async () => {
    if (!isDebug) {
      await uploadDB();
    }
    process.exit(0);
  });
}

main().catch(console.error);</code></pre>
      </div>
    </div>
    
    <!-- Dart å¼¹çª— -->
    <div x-show="showDart" x-cloak class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
      <div class="bg-white rounded-lg p-6 max-w-4xl w-full mx-4 max-h-[80vh] overflow-y-auto scrollbar-hide">
        <div class="flex justify-between items-center mb-4">
          <h3 class="text-xl font-semibold">ğŸ¯ Dart ç¤ºä¾‹</h3>
          <button @click="showDart = false" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
        </div>
        <pre class="bg-gray-100 rounded p-4 overflow-x-auto text-sm"><code>import 'dart:io';
import 'package:http/http.dart' as http;

const serverURL = 'http://your-server/api/your_project';
const token = 'YOUR_TOKEN';
const dbPath = 'data.db';

Future<void> downloadLatestDB() async {
  print('æ•°æ®åº“æ–‡ä»¶ä¸å­˜åœ¨ï¼Œä»äº‘ç«¯ä¸‹è½½æœ€æ–°ç‰ˆæœ¬...');
  try {
    final response = await http.get(
      Uri.parse('$serverURL/latest?token=$token'),
    );
    
    if (response.statusCode == 200) {
      final file = File(dbPath);
      await file.writeAsBytes(response.bodyBytes);
      print('ä¸‹è½½æˆåŠŸ');
    } else {
      print('ä¸‹è½½å¤±è´¥ï¼ŒçŠ¶æ€ç : ${response.statusCode}');
    }
  } catch (e) {
    print('ä¸‹è½½å¤±è´¥: $e');
  }
}

Future<void> uploadDB() async {
  print('æ¥æ”¶åˆ°å…³é—­ä¿¡å·ï¼Œå‡†å¤‡ä¸Šä¼ æ•°æ®åº“...');
  try {
    final dbFile = File(dbPath);
    if (!await dbFile.exists()) {
      print('æœ¬åœ°æ•°æ®åº“æ–‡ä»¶ä¸å­˜åœ¨ï¼Œæ— æ³•ä¸Šä¼ ');
      return;
    }
    
    final request = http.MultipartRequest('POST', Uri.parse(serverURL))
      ..fields['token'] = token
      ..fields['description'] = 'Upload at ${DateTime.now()}';
    
    request.files.add(
      await http.MultipartFile.fromPath('database', dbFile.path),
    );
    
    final response = await request.send();
    if (response.statusCode == 200) {
      print('ä¸Šä¼ æˆåŠŸ');
    } else {
      final body = await response.stream.bytesToString();
      if (body.contains('File already exists')) {
        print('æ•°æ®åº“æœªæ›´æ”¹ï¼Œè·³è¿‡ä¸Šä¼ ');
      } else {
        print('ä¸Šä¼ å¤±è´¥: ${response.statusCode} - $body');
      }
    }
  } catch (e) {
    print('ä¸Šä¼ å¤±è´¥: $e');
  }
}

void main() async {
  final dbFile = File(dbPath);
  if (!await dbFile.exists()) {
    await downloadLatestDB();
  }
  
  final isDebug = const bool.fromEnvironment('DEBUG', defaultValue: false);
  
  ProcessSignal.sigint.watch().listen((signal) async {
    if (!isDebug) {
      await uploadDB();
    }
    exit(0);
  });
  
  ProcessSignal.sigterm.watch().listen((signal) async {
    if (!isDebug) {
      await uploadDB();
    }
    exit(0);
  });
}</code></pre>
      </div>
    </div>
  </div>
  <div class="mt-8 text-gray-500 text-sm">
    å¦‚éœ€æ›´å¤šè¯­è¨€ç¤ºä¾‹æˆ–æœ‰å…¶ä»–é—®é¢˜ï¼Œè¯·è”ç³»ç»´æŠ¤è€…ã€‚
  </div>
</div>
{{end}}